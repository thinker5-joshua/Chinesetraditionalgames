# 实现64卦配对游戏的"去学卦"功能

## 功能需求分析
1. 在64卦主页面底部偏右侧增加"去学卦"按钮
2. 点击按钮进入卦列表页，每次展示8个卦，共8组，可前后翻阅
3. 卦分组方式：
   - 顺序：通行本《周易》按原有顺序，每8卦一组
   - 八宫：汉代京房八宫卦体系，8宫×8卦
4. 点选卦可进入卦详情页

## 实现步骤

### 1. HTML结构调整
- 在`index.html`中添加"去学卦"按钮
- 创建卦列表页的HTML结构
- 创建卦详情页的HTML结构
- 添加分组选择UI元素

### 2. JavaScript功能实现
- **64卦数据处理**：
  - 保留现有的`hexagramsData`数组
  - 实现八宫卦分组逻辑
- **页面切换逻辑**：
  - 主页面与卦列表页的切换
  - 卦列表页与卦详情页的切换
- **卦列表功能**：
  - 实现分组展示（顺序/八宫）
  - 实现翻页功能
  - 实现卦选点功能
- **分组切换功能**：
  - 实现两种分组方式的切换
  - 更新分组数据和UI

### 3. CSS样式调整
- 添加卦列表页样式
- 添加卦详情页样式
- 添加分组选择样式
- 添加翻页按钮样式

## 代码实现细节

### 1. HTML结构
```html
<!-- 主页面添加去学卦按钮 -->
<div class="learn-button-container">
  <button id="go-learn" class="learn-button">去学卦</button>
</div>

<!-- 卦列表页 -->
<div id="learn-page" class="page learn-page" style="display: none;">
  <div class="page-header">
    <h2>64卦学习</h2>
    <button id="back-to-game" class="back-button">返回游戏</button>
  </div>
  
  <!-- 分组选择 -->
  <div class="group-selector">
    <label>分组方式：</label>
    <button id="order-group" class="group-button active">顺序</button>
    <button id="eight-house-group" class="group-button">八宫</button>
  </div>
  
  <!-- 卦列表 -->
  <div class="hexagram-list-container">
    <div id="hexagram-list" class="hexagram-list">
      <!-- 卦项将动态生成 -->
    </div>
  </div>
  
  <!-- 翻页控件 -->
  <div class="pagination">
    <button id="prev-group" class="page-button">上一组</button>
    <span id="group-info" class="group-info">第1组 / 共8组</span>
    <button id="next-group" class="page-button">下一组</button>
  </div>
</div>

<!-- 卦详情页（复用现有模态框或创建新页面） -->
```

### 2. JavaScript核心功能

#### 八宫卦分组数据
```javascript
// 八宫卦分组
const eightHouseGroups = [
  { name: "乾宫", hexagrams: [1, 29, 17, 2, 11, 34, 43, 3] },
  { name: "兑宫", hexagrams: [58, 41, 62, 59, 28, 10, 54, 40] },
  { name: "离宫", hexagrams: [30, 13, 22, 37, 55, 21, 36, 23] },
  { name: "震宫", hexagrams: [51, 57, 24, 20, 3, 25, 53, 32] },
  { name: "巽宫", hexagrams: [57, 31, 60, 5, 44, 38, 50, 19] },
  { name: "坎宫", hexagrams: [29, 63, 39, 52, 4, 47, 27, 48] },
  { name: "艮宫", hexagrams: [52, 56, 26, 33, 6, 46, 35, 15] },
  { name: "坤宫", hexagrams: [2, 12, 16, 8, 23, 45, 30, 14] }
];
```

#### 页面切换逻辑
```javascript
// 去学卦按钮点击事件
document.getElementById('go-learn').addEventListener('click', () => {
  document.querySelector('.game-container').style.display = 'none';
  document.getElementById('learn-page').style.display = 'block';
  initLearnPage();
});

// 返回游戏按钮点击事件
document.getElementById('back-to-game').addEventListener('click', () => {
  document.getElementById('learn-page').style.display = 'none';
  document.querySelector('.game-container').style.display = 'block';
});
```

#### 卦列表初始化和渲染
```javascript
let currentGroupType = 'order'; // 或 'eight-house'
let currentGroupIndex = 0;

function initLearnPage() {
  renderHexagramList();
  setupGroupButtons();
  setupPagination();
}

function renderHexagramList() {
  const hexagramList = document.getElementById('hexagram-list');
  const groupInfo = document.getElementById('group-info');
  
  // 根据分组类型获取当前组的卦
  let currentGroupHexagrams;
  if (currentGroupType === 'order') {
    // 顺序分组
    const startIndex = currentGroupIndex * 8;
    currentGroupHexagrams = hexagramsData.slice(startIndex, startIndex + 8);
  } else {
    // 八宫分组
    const group = eightHouseGroups[currentGroupIndex];
    currentGroupHexagrams = group.hexagrams.map(id => 
      hexagramsData.find(h => h.id === id)
    );
  }
  
  // 渲染卦列表
  hexagramList.innerHTML = currentGroupHexagrams.map(hexagram => `
    <div class="hexagram-item" data-id="${hexagram.id}">
      <div class="hexagram-item-symbol">${hexagram.symbol}</div>
      <div class="hexagram-item-name">${hexagram.name}</div>
      <div class="hexagram-item-pinyin">${hexagram.pinyin}</div>
    </div>
  `).join('');
  
  // 更新组信息
  groupInfo.textContent = `第${currentGroupIndex + 1}组 / 共8组`;
  
  // 添加卦项点击事件
  hexagramList.querySelectorAll('.hexagram-item').forEach(item => {
    item.addEventListener('click', () => {
      const hexagramId = parseInt(item.dataset.id);
      const hexagram = hexagramsData.find(h => h.id === hexagramId);
      showHexagramDetail(hexagram);
    });
  });
}
```

#### 分组切换和翻页功能
```javascript
function setupGroupButtons() {
  // 顺序分组按钮
  document.getElementById('order-group').addEventListener('click', () => {
    currentGroupType = 'order';
    currentGroupIndex = 0;
    updateGroupButtons();
    renderHexagramList();
  });
  
  // 八宫分组按钮
  document.getElementById('eight-house-group').addEventListener('click', () => {
    currentGroupType = 'eight-house';
    currentGroupIndex = 0;
    updateGroupButtons();
    renderHexagramList();
  });
}

function updateGroupButtons() {
  // 更新分组按钮的active状态
  document.querySelectorAll('.group-button').forEach(btn => {
    btn.classList.remove('active');
  });
  if (currentGroupType === 'order') {
    document.getElementById('order-group').classList.add('active');
  } else {
    document.getElementById('eight-house-group').classList.add('active');
  }
}

function setupPagination() {
  // 上一组按钮
  document.getElementById('prev-group').addEventListener('click', () => {
    if (currentGroupIndex > 0) {
      currentGroupIndex--;
      renderHexagramList();
    }
  });
  
  // 下一组按钮
  document.getElementById('next-group').addEventListener('click', () => {
    if (currentGroupIndex < 7) {
      currentGroupIndex++;
      renderHexagramList();
    }
  });
}
```

### 3. CSS样式设计

#### 主页面按钮样式
```css
.learn-button-container {
  position: fixed;
  bottom: 20px;
  right: 20px;
}

.learn-button {
  padding: 10px 20px;
  font-size: 16px;
  background-color: #4CAF50;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
}

.learn-button:hover {
  background-color: #45a049;
}
```

#### 卦列表页样式
```css
.learn-page {
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.group-selector {
  display: flex;
  align-items: center;
  margin-bottom: 20px;
}

.group-button {
  margin: 0 5px;
  padding: 8px 16px;
  border: 1px solid #ccc;
  border-radius: 5px;
  background-color: #f0f0f0;
  cursor: pointer;
}

.group-button.active {
  background-color: #4CAF50;
  color: white;
  border-color: #4CAF50;
}

.hexagram-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}

.hexagram-item {
  text-align: center;
  padding: 15px;
  border: 1px solid #ddd;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
}

.hexagram-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.hexagram-item-symbol {
  font-size: 3rem;
  margin-bottom: 10px;
}

.hexagram-item-name {
  font-weight: bold;
  margin-bottom: 5px;
}

.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
}

.page-button {
  padding: 10px 20px;
  border: 1px solid #ccc;
  border-radius: 5px;
  background-color: #f0f0f0;
  cursor: pointer;
}

.page-button:hover {
  background-color: #e0e0e0;
}
```

## 实现注意事项
1. 复用现有的卦详情模态框，避免重复代码
2. 确保两种分组方式的数据准确性，特别是八宫卦的分组
3. 实现响应式设计，适配不同屏幕尺寸
4. 保持与现有游戏风格的一致性
5. 确保页面切换流畅，用户体验良好

## 测试计划
1. 测试"去学卦"按钮功能
2. 测试卦列表页的分组展示和翻页功能
3. 测试两种分组方式的切换功能
4. 测试卦详情页的展示功能
5. 测试返回游戏功能
6. 测试响应式设计适配